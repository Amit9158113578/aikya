<?xml version="1.0" encoding="UTF-8"?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"

       xmlns:cxf="http://camel.apache.org/schema/blueprint/cxf"

       xsi:schemaLocation="

       http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd

        http://camel.apache.org/schema/blueprint/cxf http://camel.apache.org/schema/blueprint/cxf/camel-cxf.xsd

       http://camel.apache.org/schema/blueprint http://camel.apache.org/schema/blueprint/camel-blueprint.xsd">

 

<cxf:rsServer id="ProposalReaderEndPoint" address="/proposalreader" serviceClass="com.idep.ProposalReader.service.ProposalReaderService" loggingFeatureEnabled="true">

<cxf:providers>

        <bean class="org.apache.cxf.rs.security.cors.CrossOriginResourceSharingFilter" />

</cxf:providers>

</cxf:rsServer>
  <bean id="ProposalReaderServiceImpl" class="com.idep.ProposalReader.serviceImpl.ProposalReaderServiceImpl" />
  <bean id="ProposalReaderServiceProcessor" class="com.idep.ProposalReader.processor.ProposalReaderServiceProcessor" />    
 <bean  id="ProposalReaderProcessor" class="com.idep.ProposalReader.processor.ProposalReaderProcessor" />
  <camelContext xmlns="http://camel.apache.org/schema/blueprint">
    <route id="ProposalReaderroute">
      <from uri="cxfrs:bean:ProposalReaderEndPoint"/>
      <choice>
      <when>  
       <simple>${header.operationName} == "FindProposalData"</simple>
      
      <bean ref="ProposalReaderServiceImpl" method="FindProposalData" id="ProposalReaderBean"/>
    <process ref="ProposalReaderServiceProcessor" id="ProposalReaderProcessordata"/>
    <log message="Proposal reader Data Processor Complete"></log>
    <marshal>
    <json prettyPrint="true" library="Jackson"/>
    </marshal>
    </when>
        <when>  
       <simple>${header.operationName} == "readProposalDetails"</simple>
      
      <bean ref="ProposalReaderServiceImpl" method="FindProposalData" id="ProposalReaderBeanDetails"/>
    <process ref="ProposalReaderProcessor" id="ProposalReaderProcessorRead"/>
    <log message="Proposal Details reading Completed ${body} "></log>
    
    
    </when>
    
    
    </choice>
    </route>
  </camelContext>

</blueprint>
